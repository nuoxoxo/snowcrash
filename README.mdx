```b
flag00  nottoohardhere 
level01  x24ti5gi3x0ol2eh4esiuxias

flag01  abcdefg
level02  f2av5il02puano7naaf6adaaf

flag02  ft_waNDReL0L
level03  kooda2puivaav1idi4f57q8iq
```


# SSH

```b
$ ifconfig
$ ifconfig | grep inet
$ ifconfig | grep 'inet ' | awk 'NR==2'
$ ssh level00@$(ifconfig | grep 'inet ' | awk 'NR==2 {print $2}') -p 4242
```

# 00

- to begin with

```b
$ ls -l
$ find / -user level00 
$ find / -user level00 2>/dev/null
$ find / -user flag00 2>/dev/null
$ find / -user flag00 -exec cat {} + 2>/dev/null\
cdiiddwpgswtgt
cdiiddwpgswtgt
```

- command explained
    - `/` - from root directory
    - `+` - forces `find` to run `cat` on many files at once and not one at a time
    - `2>/dev/null` - redir stderr output to `/dev/null`
- decipher ___`cdiiddwpgswtgt`___ in python

```py
a = ord('a')
for i in range(26):
    print(i, ''.join(chr(a + (ord(c) - a + i) % 26) for c in 'cdiiddwpgswtgt'))
```

# 00 - token

```b
> su flag00
Password: nottoohardhere
> su level01
> Password: x24ti5gi3x0ol2eh4esiuxias
```


# 01

- take a look at legacy folder `/etc/passwd`

```b
$ cat /etc/passwd
$ cat /etc/passwd | grep -i flag01 | awk -F: '{print $2}'


😀 if we have john we'll able to do:
$ john --show <(cat /etc/passwd | grep -i flag01 | awk -F: '{print $2}')
```

- use our own _`do_john`_ script

```b
$ chmod +x do_john.sh
$ ./do_john.sh
```

- or download and use _`john`_

```b
$ wget https://download.openwall.net/pub/projects/john/contrib/macosx/john-1.8.0.9-jumbo-macosx_sse4.zip
$ tar -xvf john-1.8.0.9-jumbo-macosx_sse4.zip
$ cd john-1.8.0.9-jumbo-macosx_sse4
$ echo 42hDRfypTqqnw > __test
$ ./john __test
$ ./john --show __test
```

# 01 - token

```b
> su flag01
Password: abcdefg
> su level02
> Password: f2av5il02puano7naaf6adaaf
```


# 02

- new stuff
  - `realpath` - get the full absolute filepath
  - `scp` - secure copy - `scp username@ip:path _local_`
  - `~.pcap` - a Packet Capture to store network packet data captured during network traffic monitoring

- save the `.pcap` to Host
```b
### VM
> ls -l
----r--r-- 1 flag02 level02 level02.pcap
^ which means a regular file

> scp -P 4242 level02@$(ifconfig|grep 'inet '|awk 'NR==2 {print $2}'):/home/user/level02/level02.pcap $(pwd)
```

- try inspecting the `.pcap` ❌ 

```b
### Host
> hexdump -C level02.pcap 
> xxd level02.pcap 
> xxd level02.pcap | grep -i pass -A10 -B10
> xxd level02.pcap | cut -d ' ' -f2-9 | tr -d ' '
```

- use _Wireshark_ 
  - _Analyze - Follow - TCP Stream_ 
  - copy _`TCP Stream`_ to text

```b
    000000D6  00 0d 0a 50 61 73 73 77  6f 72 64 3a 20            ...Passw ord: 
000000B9  66                                                 f
000000BA  74                                                 t
000000BB  5f                                                 _
000000BC  77                                                 w
000000BD  61                                                 a
000000BE  6e                                                 n
000000BF  64                                                 d
000000C0  72                                                 r
000000C1  7f                                                 .
000000C2  7f                                                 .
000000C3  7f                                                 .
000000C4  4e                                                 N
000000C5  44                                                 D
000000C6  52                                                 R
000000C7  65                                                 e
000000C8  6c                                                 l
000000C9  7f                                                 .
000000CA  4c                                                 L
000000CB  30                                                 0
000000CC  4c                                                 L
000000CD  0d                                                 .
```

```py
infile = [[n[-2], n[-1]] for n in [_.split() for _ in open(0).read().split('\n') if len(_.split()) == 3]]
res = ''
for i, line in enumerate(infile):
    print('line/', line, 'i/', i)
    l, r = line
    if l == '7f': res = res[:-1]
    elif r != '.': res += r
    else: assert(l == '0d')
print('res/', res)

# ft_waNDReL0L
```

# 02 - token

```b
> su flag02
Password: ft_waNDReL0L
> su level03
> Password: kooda2puivaav1idi4f57q8iq
```

